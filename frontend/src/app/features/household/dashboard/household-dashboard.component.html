<div class="household-dashboard-container">
  @if (isLoaded()) {
    <!-- Header Section -->
    <header class="dashboard-header">
      <div class="header-content">
        <div class="header-text">
          <h1 class="dashboard-title">
            <i class="pi pi-home" aria-hidden="true"></i>
            Dashboard Gospodarstwa
          </h1>
          <p class="dashboard-subtitle">{{ pageSubtitle }}</p>
        </div>

        <!-- Household Info -->
        <div class="header-info">
          <div class="info-item">
            <span class="info-label">ID Gospodarstwa</span>
            <span class="info-value">{{ householdId() }}</span>
          </div>
        </div>
      </div>
    </header>

    <p-divider></p-divider>

    <!-- Statistics Cards -->
    @if (dashboardStats()) {
      <div class="stats-grid">
        <p-card class="stat-card">
          <div class="stat-content">
            <i class="pi pi-clock stat-icon info"></i>
            <div class="stat-details">
              <div class="stat-value">{{ dashboardStats()!.pending }}</div>
              <div class="stat-label">Oczekujące</div>
            </div>
          </div>
        </p-card>

        <p-card class="stat-card">
          <div class="stat-content">
            <i class="pi pi-exclamation-triangle stat-icon warning"></i>
            <div class="stat-details">
              <div class="stat-value">{{ dashboardStats()!.overdue }}</div>
              <div class="stat-label">Przekroczone</div>
            </div>
          </div>
        </p-card>

        <p-card class="stat-card">
          <div class="stat-content">
            <i class="pi pi-check-circle stat-icon success"></i>
            <div class="stat-details">
              <div class="stat-value">{{ dashboardStats()!.completedThisMonth }}</div>
              <div class="stat-label">Wykonane w tym miesiącu</div>
            </div>
          </div>
        </p-card>
      </div>
    }

    <!-- Dashboard Widgets Section -->
    <section class="dashboard-widgets">
      <!-- Week Calendar View -->
      <div class="widget-calendar">
        <app-week-calendar-view
          [events]="filteredEvents()"
          [householdId]="householdId()"
          (eventClick)="onEventClick($event)"
          (weekChange)="onWeekChange($event)">
        </app-week-calendar-view>
      </div>

      <p-divider></p-divider>

      <!-- Event Filters Toolbar -->
      <div class="widget-header">
        <h2 class="section-title">Nadchodzące wydarzenia</h2>
      </div>

      <app-event-filters-toolbar
        [users]="[]"
        [categories]="[]"
        [selectedDays]="selectedDays()"
        (filtersChange)="onFiltersChange($event)"
        (rangeChange)="onDateRangeChange($event)">
      </app-event-filters-toolbar>

      <!-- Events List -->
      <div class="widget-events-list">
        <app-dashboard-events-list
          [events]="filteredEvents()"
          [loading]="eventsLoading()"
          (eventClick)="onEventClick($event)"
          (actionClick)="onActionClick($event)">
        </app-dashboard-events-list>
      </div>
    </section>

    <!-- Event Details Dialog -->
    <app-event-details-dialog
      [visible]="eventDialogVisible()"
      (visibleChange)="eventDialogVisible.set($event)"
      [event]="selectedEvent()"
      (action)="onEventAction($event)">
    </app-event-details-dialog>
  } @else {
    <!-- Loading state -->
    <div class="loading-container">
      <p-message
        severity="info"
        text="Ładowanie danych gospodarstwa..."
        [closable]="false">
      </p-message>
    </div>
  }
</div>
