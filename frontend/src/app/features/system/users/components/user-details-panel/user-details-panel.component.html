<div class="user-details-panel">
  <p-card>
    <ng-template pTemplate="header">
      <div class="user-header">
        <div class="user-avatar">
          {{ getUserInitials() }}
        </div>
        <div class="user-info">
          <h2>{{ user().firstName }} {{ user().lastName }}</h2>
          <p class="user-email">{{ user().email }}</p>
        </div>
      </div>
    </ng-template>

    <!-- User Details -->
    <div class="details-section">
      <h3>Account Information</h3>

      <div class="detail-row">
        <span class="detail-label">User ID:</span>
        <span class="detail-value">{{ user().id }}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Role:</span>
        <span class="detail-value">
          <p-tag
            [value]="getRoleLabel(user().role)"
            [severity]="getRoleSeverity(user().role)"
          ></p-tag>
        </span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Status:</span>
        <span class="detail-value">
          <p-tag
            [value]="getStatusLabel(user().status)"
            [severity]="getStatusSeverity(user().status)"
          ></p-tag>
        </span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Household:</span>
        <span class="detail-value">{{ user().householdName }}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Last Login:</span>
        <span class="detail-value">{{ formatDate(user().lastLogin) }}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Created:</span>
        <span class="detail-value">{{ formatDate(user().createdAt) }}</span>
      </div>

      <div class="detail-row">
        <span class="detail-label">Updated:</span>
        <span class="detail-value">{{ formatDate(user().updatedAt) }}</span>
      </div>
    </div>

    <p-divider></p-divider>

    <!-- Activity History -->
    <div class="activity-section">
      <h3>Recent Activity</h3>

      @if (isLoadingActivity()) {
        <div class="loading-skeleton">
          <p-skeleton height="3rem" styleClass="mb-2"></p-skeleton>
          <p-skeleton height="3rem" styleClass="mb-2"></p-skeleton>
          <p-skeleton height="3rem"></p-skeleton>
        </div>
      } @else if (activityHistory().length > 0) {
        <p-table [value]="activityHistory()" [tableStyle]="{ 'min-width': '100%' }">
          <ng-template pTemplate="header">
            <tr>
              <th>Action</th>
              <th>Description</th>
              <th>Timestamp</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-activity>
            <tr>
              <td>{{ activity.action }}</td>
              <td>{{ activity.description }}</td>
              <td>{{ formatDate(activity.timestamp) }}</td>
            </tr>
          </ng-template>
        </p-table>
      } @else {
        <p class="no-activity">No recent activity found</p>
      }
    </div>
  </p-card>
</div>
